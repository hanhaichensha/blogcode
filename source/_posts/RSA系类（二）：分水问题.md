title: RSA系类（二）：分水问题
tags:
  - RSA算法
  - 数学
  - 扩展辗转相除法
categories:
  - 算法
date: 2015-02-02 22:13:00
---


再次声明：本文只写给对数学或者计算机感兴趣的小伙伴们！

今天先对昨天日记有严重问题的地方进行修正：

1）还有下面这句话是有很严重的错误的，少了一个前提，为了叙述方便我们设A÷B=C···R，
下面这句话成立的条件是C=1，A：B=B：R，又因为R=A-B，从而得A：B=B：(A-B)，解出

<embed src="http://latex.codecogs.com/svg.latex?{\frac{B}{A}=\frac{\sqrt{5}-1}{2}\approx\frac{0.618}{1}} " type="image/svg+xml" />

顺便提一下，这个时候被除数和除数的比例关系正好满足黄金分割比例1：0.618

好了，现在开始解题：
#### 2、假如你有一个6升的容器和一个9升的容器（以及充足的水源，容器没有刻度），1到8升水哪些呢取出来，哪些不能取出来，为什么，假如你有一个a升的容器和一个b升的容器（以及充足的水源，容器没有刻度），1到max{a,b}-1升水哪些呢取出来，哪些不能取出来，为什么？（说明：max{a,b}表示a和b中较大的那个数）

<!--more-->

参考答案：

先从一个简单的情况说起：假如你有一个 3 升的容器和一个5升的容器（以及充足的水源），如何精确的得到4升水？

将3 升的容器记为A，5升的容器记为B：

1） 将 A 装满，此时 A 中的水为 3 升， B 中的水为 0 升；

2） 将 A 里的水全部倒入 B ，此时 A 中的水为 0 升， B 中的水为 3 升；

3） 将 A 装满，此时 A 中的水为 3 升， B 中的水为 3 升；

4） 将 A 里的水倒入 B 直到把 B 装满，此时 A 中的水为 1 升， B 中的水为 5 升；

5） 将 B 里的水全部倒掉，此时 A 中的水为 1 升， B 中的水为 0 升；

6） 将 A 里剩余的水全部倒入 B ，此时 A 中的水为 0 升， B 中的水为 1 升；

7） 将 A 装满，此时 A 中的水为 3 升， B 中的水为 1 升；

8） 将 A 里的水全部倒入 B ，此时 A 中的水为 0 升， B 中的水为 4 升；

 

现在我们尝试把这个过程用数学语言来表述一下：由于容器没有刻度，而且取水的过程都是一容器一容器的去取，由此可以得出总的取水量是A容器的整数倍，Ｂ容器倒水也是一容器一容器的倒，所以倒出去的水也就是B容器的整数倍。而最后剩余的水就是n次A容器取水的总量减掉m次B容器倒水的总量。因此得出：3×n - 5×m=4，求出m,n就能得到结果。现在的问题来了，这个二元不定方程怎么求呢？有小伙伴说哪来那么多事，写个程序，直接从1开始，一个一个的往后面试就是了。这个小伙伴的方法很好，从这可以看出这个小伙伴是一个直截了当或者说简单粗暴的人，我喜欢，哈哈。不过，这里有个方法你可以试一试，如果我们能求出3×n’ + 5×m’=1,那么就能很快得出3×n’×4 - 5×(-m’)×4=4，要求解这个3×n’ + 5×m’=1这个不定式，我们得先回顾一下第一道题里面的辗转相除法：

1）210 ÷165=1 ···45（余数）；

2）165÷45=3···30（余数）；

3）45÷30=1···15（余数）；

4）30÷15=2···0（余数）；

我们这样就能确定出最大公因数15，现在我们把上面的步骤换一种表示方法：

1）45=210×1+165×(-1)；

2）30=165×1+45×(-3)；

3）15=45×1+30×(-1)；

4）0=30×1+15×(-2)；

现在我们忽略最后一个等式，把45和30这两个数看做是两个未知数，然后将2）式代入3）式替换掉30，再将结果等式中的45用1）式替换，也就是从下往上，依次将上面一个等式右边的式子代换掉下面等式右边式子中等于上面等式左边的那个数：

<embed src="http://latex.codecogs.com/svg.latex?{\left.\begin{aligned}30&=&165\times1+45\times(-3)\\15&=&45\times1+30\times(-1)\end{aligned}\right\}\Rightarrow15=45\times1+[165\times1+45\times(-3)]\times(-1) }" type="image/svg+xml" />

化简得15=45×4+165×(-1)，再将1）式替换掉45得：

15=[210×1+165×(-1)]×4+165×(-1)，化简得：210×4+165×(-5)=15，好神奇的一种方法呀，最后居然化简出了一个由原来被除数和除数做为系数，最大公约数作为结果的一个等式，我们可以按照刚才的那种方法来求解任何一个满足ax+by=a和b最大公约数的不定方程，这种求解方法叫做[扩展欧几里得算法](https://zh.wikipedia.org/wiki/扩展欧几里得算法)或者[扩展辗转相除法](https://zh.wikipedia.org/wiki/扩展欧几里得算法)。我们可以来试一试3×n’ + 5×m’=1这个不定方程，因为3和5的最大公因数就是1,从而满足要求，先对5和3进行辗转相除法：

1）5÷3=1 ···2（余数）；

2）3÷2=1···1（余数）；

3）2÷1=2···0（余数）；

转换一下：

1）2=5×1+3×(-1)；

2）1=3×1+2×(-1)；

代入的：

3×2 + 5×(-1)=1  

所以n’=2，m’=-1；

最后，我们求解一下3×n - 5×m=4这个不定方程：

3×2 + 5×(-1)=1两边同时乘以4得：3×8 + 5×(-4)=4，从而得出：n=8，m=-4，有些聪明的小伙伴就会说：“我书读的少，你不要骗我，这个结果跟前面倒水过程的结果明显不相等”，好吧，我承认我是在忽悠你，这个结果其实很明显了：由于3的5倍刚好等于5的3倍，等式再变换一下的：3×3 + 3×5 + 5×(-4) = 3×3 + 5×(-1)，这种简单情况终于解释完了。

回答一下原始问题：6升和9升的容器，根据上面的结论，应该很容易得出：6x+9y=3一定有解的，同时能准确取出3的倍数升水。所以1到8升水中3升和6升水是可以取出来的，那其余的能取出来吗，为什么呢？答案是不能，有兴趣的小伙伴可以去查看[裴蜀定理](https://zh.wikipedia.org/wiki/貝祖等式)。从上面的分析，我们能得出，a升和b升容器的答案：在区间[1,max{a,b}-1]上的a和b的最大公约数的整数倍是能够精确取出来的。

参考资料：
1. [跨越千年的RSA算法](http://www.matrix67.com/blog/archives/5100)
2. [RSA算法原理](http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html)